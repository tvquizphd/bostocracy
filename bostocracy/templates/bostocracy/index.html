{% extends "bostocracy/layout.html" %}
{% load static %}

{% block title %}
BOS
{% endblock %}

{% block body %}
    {% if user.is_authenticated %}
      <layer-map></layer-map>
    {% else %}
      <layer-map></layer-map>
    {% endif %}

    <template id="layer-map-view">
      <div id='map'></div>
    </template>
{% endblock %}

{% block script %}
    <script type="importmap">
      {
        "imports": {
          "api": "{% static 'bostocracy/api.js' %}",
          "color": "{% static 'bostocracy/color.js' %}",
          "tags": "{% static 'bostocracy/tags.js' %}",
          "index": "{% static 'bostocracy/index.js' %}",
          "angles": "{% static 'bostocracy/angles.js' %}",
          "actions": "{% static 'bostocracy/actions.js' %}",
          "layer-map": "{% static 'bostocracy/layer-map.js' %}",
          "layer-changes": "{% static 'bostocracy/layer-changes.js' %}",
          "style-layer-map": "{% static 'bostocracy/layer-map.css' %}",
          "config-layer-map": "{% static 'bostocracy/config-layer-map.js' %}",
          "L": "https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",
          "style-leaflet": "https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",
          "esri-leaflet": "https://unpkg.com/esri-leaflet@3.0.12/dist/esri-leaflet.js"
        },
        "integrity": {
          "https://unpkg.com/leaflet@1.9.4/dist/leaflet.js": "sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=",
          "https://unpkg.com/leaflet@1.9.4/dist/leaflet.css": "sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
        }
      }
    </script>
    <script type="module">
      import { index } from 'index';
      index({
        username: "{{ user.username }}"
      });
    </script>
{% endblock %}
